/*
	Copyright (c) 2004-2007, The Dojo Foundation
	All Rights Reserved.

	Licensed under the Academic Free License version 2.1 or above OR the
	modified BSD license. For more information on Dojo licensing, see:

		http://dojotoolkit.org/book/dojo-book-0-9/introduction/licensing
*/


if(!dojo._hasResource["dojo.dnd.move"]){dojo._hasResource["dojo.dnd.move"]=true;dojo.provide("dojo.dnd.move");dojo.require("dojo.dnd.Mover");dojo.require("dojo.dnd.Moveable");dojo.declare("dojo.dnd.move.constrainedMoveable",dojo.dnd.Moveable,{constraints:function(){},within:false,markupFactory:function(_1,_2){return new dojo.dnd.move.constrainedMoveable(_2,_1);},constructor:function(_3,_4){if(!_4){_4={};}this.constraints=_4.constraints;this.within=_4.within;},onFirstMove:function(_5){var c=this.constraintBox=this.constraints.call(this,_5),m=_5.marginBox;c.r=c.l+c.w-(this.within?m.w:0);c.b=c.t+c.h-(this.within?m.h:0);},onMove:function(_8,_9){var c=this.constraintBox;_9.l=_9.l<c.l?c.l:c.r<_9.l?c.r:_9.l;_9.t=_9.t<c.t?c.t:c.b<_9.t?c.b:_9.t;dojo.marginBox(_8.node,_9);}});dojo.declare("dojo.dnd.move.boxConstrainedMoveable",dojo.dnd.move.constrainedMoveable,{box:{},markupFactory:function(_b,_c){return new dojo.dnd.move.boxConstrainedMoveable(_c,_b);},constructor:function(_d,_e){var _f=_e&&_e.box;this.constraints=function(){return _f;};}});dojo.declare("dojo.dnd.move.parentConstrainedMoveable",dojo.dnd.move.constrainedMoveable,{area:"content",markupFactory:function(_10,_11){return new dojo.dnd.move.parentConstrainedMoveable(_11,_10);},constructor:function(_12,_13){var _14=_13&&_13.area;this.constraints=function(){var n=this.node.parentNode,s=dojo.getComputedStyle(n),mb=dojo._getMarginBox(n,s);if(_14=="margin"){return mb;}var t=dojo._getMarginExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;if(_14=="border"){return mb;}t=dojo._getBorderExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;if(_14=="padding"){return mb;}t=dojo._getPadExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;return mb;};}});dojo.dnd.move.constrainedMover=function(fun,_1a){var _1b=function(_1c,e,_1e){dojo.dnd.Mover.call(this,_1c,e,_1e);};dojo.extend(_1b,dojo.dnd.Mover.prototype);dojo.extend(_1b,{onMouseMove:function(e){dojo.dnd.autoScroll(e);var m=this.marginBox,c=this.constraintBox,l=m.l+e.pageX,t=m.t+e.pageY;l=l<c.l?c.l:c.r<l?c.r:l;t=t<c.t?c.t:c.b<t?c.b:t;this.host.onMove(this,{l:l,t:t});},onFirstMove:function(){dojo.dnd.Mover.prototype.onFirstMove.call(this);var c=this.constraintBox=fun.call(this),m=this.marginBox;c.r=c.l+c.w-(_1a?m.w:0);c.b=c.t+c.h-(_1a?m.h:0);}});return _1b;};dojo.dnd.move.boxConstrainedMover=function(box,_27){return dojo.dnd.move.constrainedMover(function(){return box;},_27);};dojo.dnd.move.parentConstrainedMover=function(_28,_29){var fun=function(){var n=this.node.parentNode,s=dojo.getComputedStyle(n),mb=dojo._getMarginBox(n,s);if(_28=="margin"){return mb;}var t=dojo._getMarginExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;if(_28=="border"){return mb;}t=dojo._getBorderExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;if(_28=="padding"){return mb;}t=dojo._getPadExtents(n,s);mb.l+=t.l,mb.t+=t.t,mb.w-=t.w,mb.h-=t.h;return mb;};return dojo.dnd.move.constrainedMover(fun,_29);};dojo.dnd.constrainedMover=dojo.dnd.move.constrainedMover;dojo.dnd.boxConstrainedMover=dojo.dnd.move.boxConstrainedMover;dojo.dnd.parentConstrainedMover=dojo.dnd.move.parentConstrainedMover;}