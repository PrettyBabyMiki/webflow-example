<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	    		xmlns:ui="http://java.sun.com/jsf/facelets"
	  			xmlns:h="http://java.sun.com/jsf/html"
	  			xmlns:f="http://java.sun.com/jsf/core"
	  			xmlns:p="http://primefaces.prime.com.tr/ui"
				template="/WEB-INF/layouts/standard.xhtml">
<ui:define name="notes">
	<p>
		Check the calendar widget and the tooltips on the credit card fields.
		The form uses Ajax-based validations to redisplay server-side errors without refreshing the entire page.
		The booking bean backing the form is a flow-scoped object (see <strong>booking-flow.xml</strong>).		
	</p>
</ui:define>
<ui:define name="content">
	<div class="span-5">
		<h3>${booking.hotel.name}</h3>
		<address>
			${booking.hotel.address}
			<br/>
			${booking.hotel.city}, ${booking.hotel.state}, ${booking.hotel.zip}
			<br/>
			${booking.hotel.country}
		</address>
	</div>
	<h:form id="bookingForm">
		<p:fieldset legend="Book Hotel">
			<p:messages />
			<div>
				<div class="span-4 label">
					Nightly rate:	
				</div>
				<div class="span-7 last">
					<p>
						<h:outputText value="#{booking.hotel.price}">
							<f:convertNumber type="currency" currencySymbol="$"/>
						</h:outputText>
					</p>
				</div>					
			</div>
			<div>
				<div class="span-4">
					<h:outputLabel for="checkinDate">Check In:</h:outputLabel>
				</div>
				<div class="span-7 last">
					<p>
						<p:calendar id="checkinDate" value="#{booking.checkinDate}" pattern="MM-dd-yyyy" timeZone="EST" required="true" />
	               	</p>
				</div>
			</div>
			<div class="field">
				<div class="span-4">
					<h:outputLabel for="checkoutDate">Check Out:</h:outputLabel>
				</div>
				<div class="span-7 last">
					<p>
						<p:calendar id="checkoutDate" value="#{booking.checkoutDate}" pattern="MM-dd-yyyy" timeZone="EST" required="true" />
					</p>
				</div>
			</div>
			<div class="field">
				<div class="span-4">
					<h:outputLabel for="beds">Room Preference:</h:outputLabel>
				</div>
				<div class="span-7 last">
					<p>
						<h:selectOneMenu id="beds" value="#{booking.beds}">
							<f:selectItems value="#{referenceData.bedOptions}"/>
						</h:selectOneMenu>
					</p>	
				</div>
			</div>
			<div class="field">
				<div class="span-4">
					<h:outputLabel for="smoking">Smoking Preference:</h:outputLabel>
				</div>
				<div id="radio" class="span-7 last">
					<h:selectOneRadio id="smoking" value="#{booking.smoking}" layout="pageDirection">
						<f:selectItems value="#{referenceData.smokingOptions}"/>
					</h:selectOneRadio>
				</div>
			</div>
			<!-- 
			The "amenities" section commented out due to the following issue:
			
			https://issues.apache.org/jira/browse/MYFACES-2739
			https://javaserverfaces-spec-public.dev.java.net/issues/show_bug.cgi?id=817
			https://javaserverfaces.dev.java.net/issues/show_bug.cgi?id=1694
			
			<div class="field">
				<div class="span-4">
					<h:outputLabel for="amenities">Amenities:</h:outputLabel>
				</div>
				<div class="span-7 last">
					<h:selectManyCheckbox id="amenities" value="#{booking.amenities}" layout="pageDirection">
						<f:selectItem itemValue="OCEAN_VIEW" itemLabel="Ocean View" />
						<f:selectItem itemValue="LATE_CHECKOUT" itemLabel="Late Checkout" />
						<f:selectItem itemValue="MINIBAR" itemLabel="Minibar" />
					</h:selectManyCheckbox>
				</div>
			</div>

			-->
			<div class="field">
				<div class="span-4">
					<h:outputLabel for="creditCard">Credit Card #:</h:outputLabel>
				</div>
				<div class="span-7 last">
					<p>
						<h:inputText id="creditCard" value="#{booking.creditCard}">
							<f:validateRegex pattern="[0-9]{16}" />
						</h:inputText>
						<p:tooltip for="creditCard" value="16-digit credit card number." style="cream" position="bottomLeft" />
					</p>
				</div>
			</div>
			<div class="field">
				<div class="span-4">
					<h:outputLabel for="creditCardName">Credit Card Name:</h:outputLabel>
				</div>
				<div class="span-7 last">
					<p>
						<h:inputText id="creditCardName" value="#{booking.creditCardName}">
							<f:validateLength minimum="3" /> 
						</h:inputText>
						<p:tooltip for="creditCardName" value="The name as it appears on the credit card" style="cream" position="bottomLeft" />
					</p>
				</div>
			</div>
			<div class="field">
				<div class="span-4">
					<h:outputLabel for="creditCardExpiryMonth">Expiration Date:</h:outputLabel>
				</div>
				<div class="span-7 last">
					<p>
						<h:selectOneMenu id="creditCardExpiryMonth" value="#{booking.creditCardExpiryMonth}">
							<f:selectItems value="#{referenceData.creditCardExpMonths}" />
						</h:selectOneMenu>
						<h:selectOneMenu id="creditCardExpiryYear" value="#{booking.creditCardExpiryYear}">
							<f:selectItems value="#{referenceData.creditCardExpYears}"/>
						</h:selectOneMenu>
					</p>
				</div>
			</div>
			<div>
				<p:commandButton id="proceed" action="proceed" value="Proceed" update="@form" />
				<p:commandButton id="cancel" value="Cancel" action="cancel" immediate="true" />
			</div>		
		</p:fieldset>
	</h:form>
</ui:define>
</ui:composition>